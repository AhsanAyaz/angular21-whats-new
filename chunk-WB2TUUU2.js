import{Ca as M,L as m,R as c,T as a,Va as N,Wa as O,a as y,c as b,o as R,va as P}from"./chunk-74OKKCYJ.js";var d=class t{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(r=>{let n=r.indexOf(":");if(n>0){let o=r.slice(0,n),i=r.slice(n+1).trim();this.addHeaderEntry(o,i)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((r,n)=>{this.addHeaderEntry(n,r)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([r,n])=>{this.setHeaderEntries(r,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let r=this.headers.get(e.toLowerCase());return r&&r.length>0?r[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,r){return this.clone({name:e,value:r,op:"a"})}set(e,r){return this.clone({name:e,value:r,op:"s"})}delete(e,r){return this.clone({name:e,value:r,op:"d"})}maybeSetNormalizedName(e,r){this.normalizedNames.has(r)||this.normalizedNames.set(r,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(r=>{this.headers.set(r,e.headers.get(r)),this.normalizedNames.set(r,e.normalizedNames.get(r))})}clone(e){let r=new t;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([e]),r}applyUpdate(e){let r=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,r);let o=(e.op==="a"?this.headers.get(r):void 0)||[];o.push(...n),this.headers.set(r,o);break;case"d":let i=e.value;if(!i)this.headers.delete(r),this.normalizedNames.delete(r);else{let s=this.headers.get(r);if(!s)return;s=s.filter(l=>i.indexOf(l)===-1),s.length===0?(this.headers.delete(r),this.normalizedNames.delete(r)):this.headers.set(r,s)}break}}addHeaderEntry(e,r){let n=e.toLowerCase();this.maybeSetNormalizedName(e,n),this.headers.has(n)?this.headers.get(n).push(r):this.headers.set(n,[r])}setHeaderEntries(e,r){let n=(Array.isArray(r)?r:[r]).map(i=>i.toString()),o=e.toLowerCase();this.headers.set(o,n),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(r=>e(this.normalizedNames.get(r),this.headers.get(r)))}};var S="text/plain",B="application/json",fe=`${B}, ${S}, */*`;var T=(function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t})(T||{}),g=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,r=200,n="OK"){this.headers=e.headers||new d,this.status=e.status!==void 0?e.status:r,this.statusText=e.statusText||n,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}};var h=class t extends g{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=T.Response;clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}};var D=new c("");var z=new c(""),X="b",J="h",V="s",$="st",G="u",W="rt",v=new c(""),K=["GET","HEAD"];function Y(t,e){let w=a(v),{isCacheActive:r}=w,n=b(w,["isCacheActive"]),{transferCache:o,method:i}=t;if(!r||o===!1||i==="POST"&&!n.includePostRequests&&!o||i!=="POST"&&!K.includes(i)||!n.includeRequestsWithAuthHeaders&&q(t)||n.filter?.(t)===!1)return e(t);let s=a(P);if(a(z,{optional:!0}))throw new m(2803,!1);let f=t.url,A=Z(t,f),E=s.get(A,null),k=n.includeHeaders;if(typeof o=="object"&&o.includeHeaders&&(k=o.includeHeaders),E){let{[X]:u,[W]:_,[J]:x,[V]:F,[$]:j,[G]:L}=E,p=u;switch(_){case"arraybuffer":p=new TextEncoder().encode(u).buffer;break;case"blob":p=new Blob([u]);break}let C=new d(x);return R(new h({body:p,headers:C,status:F,statusText:j,url:L}))}return e(t)}function q(t){return t.headers.has("authorization")||t.headers.has("proxy-authorization")}function I(t){return[...t.keys()].sort().map(e=>`${e}=${t.getAll(e)}`).join("&")}function Z(t,e){let{params:r,method:n,responseType:o}=t,i=I(r),s=t.serializeBody();s instanceof URLSearchParams?s=I(s):typeof s!="string"&&(s="");let l=[n,o,e,s,i].join("|"),f=Q(l);return f}function Q(t){let e=0;for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function _e(t){return[{provide:v,useFactory:()=>(M("NgHttpTransferCache"),y({isCacheActive:!0},t))},{provide:D,useValue:Y,multi:!0},{provide:N,multi:!0,useFactory:()=>{let e=a(O),r=a(v);return()=>{e.whenStable().then(()=>{r.isCacheActive=!1})}}}]}export{_e as a};
